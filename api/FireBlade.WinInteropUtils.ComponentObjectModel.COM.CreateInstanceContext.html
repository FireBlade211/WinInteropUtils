<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Enum COM.CreateInstanceContext | WinInteropUtils </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Enum COM.CreateInstanceContext | WinInteropUtils ">
      
      <meta name="description" content="Values that are used in activation calls to indicate the execution contexts in which an object is to be run. Used in .">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/FireBlade211/WinInteropUtils/new/main/apiSpec/new?filename=FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext.md&amp;value=---%0Auid%3A%20FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="WinInteropUtils">
            WinInteropUtils
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext">




  <h1 id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext" data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext" class="text-break">
Enum COM.CreateInstanceContext  <a class="header-action link-secondary" title="View source" href="https://github.com/FireBlade211/WinInteropUtils/blob/main/WinInteropUtils/ComponentObjectModel/COM.cs/#L317"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="FireBlade.html">FireBlade</a>.<a class="xref" href="FireBlade.WinInteropUtils.html">WinInteropUtils</a>.<a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.html">ComponentObjectModel</a></dd></dl>
  <dl><dt>Assembly</dt><dd>WinInteropUtils.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Values that are used in activation calls to indicate the execution contexts in which an object is to
be run. Used in <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstance__1_System_Guid_FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IUnknown_FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_System_Guid___0__">CreateInstance&lt;TCoInterface&gt;(Guid, IUnknown?, CreateInstanceContext, Guid, out TCoInterface?)</a>.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">[Flags]
public enum COM.CreateInstanceContext</code></pre>
  </div>








  <dl class="typelist extensionMethods">
    <dt>Extension Methods</dt>
    <dd>
  <div>
      <a class="xref" href="FireBlade.WinInteropUtils.EnumExtensions.html#FireBlade_WinInteropUtils_EnumExtensions_GetValues_System_Enum_">EnumExtensions.GetValues(Enum)</a>
  </div>
  </dd></dl>

  <h2 id="fields">Fields
</h2>
  <dl class="parameters">
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Activate32BitServer"><code>Activate32BitServer = 262144</code></dt>
  
  <dd><p>Activate or connect to a 32-bit version of the server; fail if one is not registered. (CLSCTX_ACTIVATE_32_BIT_SERVER)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Activate64BitServer"><code>Activate64BitServer = 524288</code></dt>
  
  <dd><p>Activate or connect to a 64 bit version of the server; fail if one is not registered. (CLSCTX_ACTIVATE_64_BIT_SERVER)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_ActivateActivateAsActivatorAsUI"><code>ActivateActivateAsActivatorAsUI = 8388608</code></dt>
  <dd><p>Specify this flag for Interactive User activation behavior for As-Activator servers. A strongly named Medium IL Windows Store
app can use this flag to launch an &quot;As Activator&quot; <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html">COM</a> server without a strong name. Also, you can use this flag to bind to a running
instance of the <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html">COM</a> server that's launched by a desktop application. (CLSCTX_ACTIVATE_AAA_AS_IU)</p>
<p>The client must be Medium IL, it must be strongly named, which means that it has a SysAppID in the client token, it can't be in
session 0, and it must have the same user as the session ID's user in the client token.</p>
<p>If the server is out-of-process and "As Activator", it launches the server
with the token of the client token's session user. This token won't be strongly named.</p>
<p>If the server is out-of-process and RunAs "Interactive User", this flag has no effect.</p>
<p>If the server is out-of-process and is any other RunAs type, the activation fails.</p>
<p>This flag has no effect for in-process servers.</p>
<p>Off-machine activations fail when they use this flag.</p>
</dd>
  
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_ActivateArm32Server"><code>ActivateArm32Server = 33554432</code></dt>
  
  <dd><p>CLSCTX_ACTIVATE_ARM32_SERVER</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_ActivateX86Server"><code>ActivateX86Server = 262144</code></dt>
  
  <dd><p>Activate or connect to a 32-bit version of the server; fail if one is not registered. (CLSCTX_ACTIVATE_X86_SERVER)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_AppContainer"><code>[Obsolete(&quot;This flag is reserved.&quot;, DiagnosticId = &quot;WIU128&quot;)]
AppContainer = 4194304</code></dt>
  <dd><p>Indicates activation is for an app container. (CLSCTX_APPCONTAINER)</p>
<p>This flag is reserved for internal use and is not intended to be used directly from your code.</p>
</dd>
  
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_DisableActivateAsActivator"><code>DisableActivateAsActivator = 32768</code></dt>
  
  <dd><p>Disables activate-as-activator (AAA) activations for this activation only. This flag overrides the setting of the EOAC_DISABLE_AAA
flag from the EOLE_AUTHENTICATION_CAPABILITIES enumeration. This flag cannot be set at the same time as <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_EnableActivateAsActivator">EnableActivateAsActivator</a>.
Any activation where a server process would be launched under the caller's identity is known as an activate-as-activator (AAA) activation.
Disabling AAA activations allows an application that runs under a privileged account (such as LocalSystem) to help prevent its identity
from being used to launch untrusted components. Library applications that use activation calls should always set this flag during those calls.
This helps prevent the library application from being used in an escalation-of-privilege security attack. This is the only way to disable AAA
activations in a library application because the EOAC_DISABLE_AAA flag from the EOLE_AUTHENTICATION_CAPABILITIES enumeration is applied only to
the server process and not to the library application. (CLSCTX_DISABLE_AAA)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_EnableActivateAsActivator"><code>EnableActivateAsActivator = 65536</code></dt>
  
  <dd><p>Enables activate-as-activator (AAA) activations for this activation only. This flag overrides the setting of the EOAC_DISABLE_AAA
flag from the EOLE_AUTHENTICATION_CAPABILITIES enumeration. This flag cannot be set at the same time
as <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_DisableActivateAsActivator">DisableActivateAsActivator</a>. Any activation where a server process would be launched under the caller's identity is known
as an activate-as-activator (AAA) activation. Enabling this flag allows an application to transfer its identity to an activated component. (CLSCTX_ENABLE_AAA)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_EnableCloaking"><code>EnableCloaking = 1048576</code></dt>
  
  <dd><p>When this flag is specified, <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html">COM</a> uses the impersonation token of the thread, if one is present, for the activation request
made by the thread. When this flag is not specified or if the thread does not have an impersonation token, <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html">COM</a>
uses the process token of the thread's process for the activation request made by the thread. (CLSCTX_ENABLE_CLOAKING)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_EnableCodeDownload"><code>EnableCodeDownload = 8192</code></dt>
  
  <dd><p>Enables the downloading of code from the directory service or the Internet. This flag cannot be set at the
same time as <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_NoCodeDownload">NoCodeDownload</a>. (CLSCTX_ENABLE_CODE_DOWNLOAD)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_FromDefaultContext"><code>FromDefaultContext = 131072</code></dt>
  
  <dd><p>Begin this activation from the default context of the current apartment. (CLSCTX_FROM_DEFAULT_CONTEXT)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Inproc16"><code>[Obsolete(&quot;This value is obsolete.&quot;)]
Inproc16 = 8</code></dt>
  
  <dd><p>Obsolete. (CLSCTX_INPROC_SERVER16)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_InprocHandler"><code>InprocHandler = 2</code></dt>
  
  <dd><p>The code that manages objects of this class is an in-process handler. This is a DLL that runs in the client process and implements client-side structures
of this class when instances of the class are accessed remotely. (CLSCTX_INPROC_HANDLER)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_InprocHandler16"><code>[Obsolete(&quot;This value is obsolete.&quot;)]
InprocHandler16 = 32</code></dt>
  
  <dd><p>Obsolete. (CLSCTX_INPROC_HANDLER16)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_InprocServer"><code>InprocServer = 1</code></dt>
  
  <dd><p>The code that creates and manages objects of this class is a DLL that runs in the same process as the
caller of the function specifying the class context. (CLSCTX_INPROC_SERVER)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_LocalServer"><code>LocalServer = 4</code></dt>
  
  <dd><p>The EXE code that creates and manages objects of this class runs on same machine but is loaded
in a separate process space. (CLSCTX_LOCAL_SERVER)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_NoCodeDownload"><code>NoCodeDownload = 1024</code></dt>
  
  <dd><p>Disables the downloading of code from the directory service or the Internet.
This flag cannot be set at the same time as <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_EnableCodeDownload">EnableCodeDownload</a>. (CLSCTX_NO_CODE_DOWNLOAD)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_NoCustomMarshal"><code>NoCustomMarshal = 4096</code></dt>
  
  <dd><p>Specify if you want the activation to fail if it uses custom marshalling. (CLSCTX_NO_CUSTOM_MARSHAL)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_NoFailureLog"><code>NoFailureLog = 16384</code></dt>
  
  <dd><p>The <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_NoFailureLog">NoFailureLog</a> can be used to override the logging of failures in CoCreateInstanceEx.</p>
If the ActivationFailureLoggingLevel is created, the following values can determine the status of event logging:
<ul><li>0 = Discretionary logging. Log by default, but clients can override by
specifying <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_NoFailureLog">NoFailureLog</a> in CoCreateInstanceEx.</li><li>1 = Always log all failures no matter what the client specified.</li><li>2 = Never log any failures no matter what client specified. If the registry entry is missing,
the default is 0. If you need to control customer applications, it is recommended that you set this value to 0 and write the
client code to override failures. It is strongly recommended that you do not set the value to 2. If event logging is disabled,
it is more difficult to diagnose problems.</li></ul>
(CLSCTX_NO_FAILURE_LOG)
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_ProxyStubDll"><code>[Obsolete(&quot;This value is reserved.&quot;, DiagnosticId = &quot;WIU128&quot;)]
ProxyStubDll = -2147483648</code></dt>
  <dd><p>Used for loading Proxy/Stub DLLs. (CLSCTX_PS_DLL)</p>
<p>This flag is reserved for internal use and is not intended to be used directly from your code.</p>
</dd>
  
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_RemoteServer"><code>RemoteServer = 16</code></dt>
  
  <dd><p>A remote context. The LocalServer32 or LocalService code that creates and
manages objects of this class is run on a different computer. (CLSCTX_REMOTE_SERVER)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Reserved1"><code>[Obsolete(&quot;This value is reserved.&quot;, DiagnosticId = &quot;WIU128&quot;)]
Reserved1 = 64</code></dt>
  
  <dd><p>Reserved. (CLSCTX_RESERVED1)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Reserved2"><code>[Obsolete(&quot;This value is reserved.&quot;, DiagnosticId = &quot;WIU128&quot;)]
Reserved2 = 128</code></dt>
  
  <dd><p>Reserved. (CLSCTX_RESERVED2)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Reserved3"><code>[Obsolete(&quot;This value is reserved.&quot;, DiagnosticId = &quot;WIU128&quot;)]
Reserved3 = 256</code></dt>
  
  <dd><p>Reserved. (CLSCTX_RESERVED3)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Reserved4"><code>[Obsolete(&quot;This value is reserved.&quot;, DiagnosticId = &quot;WIU128&quot;)]
Reserved4 = 512</code></dt>
  
  <dd><p>Reserved. (CLSCTX_RESERVED4)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Reserved5"><code>[Obsolete(&quot;This value is reserved.&quot;, DiagnosticId = &quot;WIU128&quot;)]
Reserved5 = 2048</code></dt>
  
  <dd><p>Reserved. (CLSCTX_RESERVED5)</p>
</dd>
    <dt id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Reserved6"><code>[Obsolete(&quot;This value is reserved.&quot;, DiagnosticId = &quot;WIU128&quot;)]
Reserved6 = 16777216</code></dt>
  
  <dd><p>This value is reserved. (CLSCTX_RESERVED6)</p>
</dd>
  </dl>


  <h2 id="FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>Values from the <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html">COM.CreateInstanceContext</a> enumeration are used in activation calls (<a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstance__1_System_Guid_FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IUnknown_FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_System_Guid___0__">CreateInstance&lt;TCoInterface&gt;(Guid, IUnknown?, CreateInstanceContext, Guid, out TCoInterface?)</a>,
CoCreateInstanceEx, CoGetClassObject, and so on) to indicate the preferred execution contexts (in-process, local, or remote) in which an
object is to be run. They are also used in calls to CoRegisterClassObject to indicate the set of execution contexts in which a class object
is to be made available for requests to construct instances.</p>
<p>To indicate that more than one context is acceptable, you can combine multiple values with Boolean ORs. The contexts
are tried in the order in which they are listed.</p>
<p>Given a set of <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html">COM.CreateInstanceContext</a> flags, the execution context to be used depends on the availability of registered class
codes and other parameters according to the following algorithm.</p>
<ol><li>
If the call specifies one of the following, <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_RemoteServer">RemoteServer</a> is implied and is added to the list of flags:
<ul><li>An explicit COSERVERINFO structure indicating a machine different from the current computer.</li><li>No explicit COSERVERINFO structure specified but the specified class is registered with either the
<a href="https://learn.microsoft.com/en-us/windows/win32/com/remoteservername">RemoteServerName</a>
or <a href="https://learn.microsoft.com/en-us/windows/win32/com/activateatstorage">ActivateAtStorage</a> registry value.</li></ul>
The second case allows applications written prior to the release of distributed <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html">COM</a> to be the configuration
of classes for remote activation to be used by client applications available prior to DCOM and the <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_RemoteServer">RemoteServer</a> flag. The cases
in which there would be no explicit COSERVERINFO structure are when the value is specified as <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a> or when it is not one of the function
parameters (as in calls to <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstance__1_System_Guid_FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IUnknown_FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_System_Guid___0__">CreateInstance&lt;TCoInterface&gt;(Guid, IUnknown?, CreateInstanceContext, Guid, out TCoInterface?)</a> and CoGetClassObject).
</li><li>If the explicit COSERVERINFO parameter indicates the current computer, <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_RemoteServer">RemoteServer</a> is removed if present.</li></ol>
<p>The rest of the processing proceeds by looking at the value(s) in the following sequence:</p>
<ol><li>If the flags include <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_RemoteServer">RemoteServer</a> and no COSERVERINFO parameter is specified and if the activation request indicates
a persistent state from which to initialize the object (with CoGetInstanceFromFile, CoGetInstanceFromIStorage, or, for a file moniker,
in a call to IMoniker::BindToObject) and the class has an
<a href="https://learn.microsoft.com/en-us/windows/win32/com/activateatstorage">ActivateAtStorage</a> subkey or no class registry information whatsoever,
the request to activate and initialize is forwarded to the computer where the persistent state resides. (Refer to the remote activation functions
listed in the See Also section for details.)</li><li>If the flags include <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_InprocServer">InprocServer</a>, the class code in the DLL found under the class's <code>InprocServer32</code>
key is used if this key exists. The class code will run within the same process as the caller.</li><li>If the flags include <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_InprocHandler">InprocHandler</a>, the class code in the DLL found under the class's <code>InprocHandler32</code> key is used if this key exists.
The class code will run within the same process as the caller.</li><li>If the flags include <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_LocalServer">LocalServer</a>, the class code in the service found under the class's <code>LocalService</code> key is used if this key exists.
If no service is specified but an EXE is specified under that same key, the class code associated with that EXE is used. The class code (in either case)
will be run in a separate service process on the same computer as the caller.</li><li>If the flag is set to <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_RemoteServer">RemoteServer</a> and an additional COSERVERINFO parameter to the function specifies a particular remote computer,
a request to activate is forwarded to this remote computer with flags modified to set to <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_LocalServer">LocalServer</a>. The class code will run in its own process
on this specific computer, which must be different from that of the caller.</li><li>Finally, if the flags include <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_RemoteServer">RemoteServer</a> and no COSERVERINFO parameter is specified and if a computer name is given under the
class's <a href="https://learn.microsoft.com/en-us/windows/win32/com/remoteservername">RemoteServerName</a> named-value, the request to activate
is forwarded to this remote computer with the flags modified to be set to <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_LocalServer">LocalServer</a>. The class code will run in its own process on
this specific computer, which must be different from that of the caller.</li></ol>
<p><i><a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Activate32BitServer">Activate32BitServer</a> and <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Activate64BitServer">Activate64BitServer</a></i></p>
<p>The 64-bit versions of Windows introduce two new flags: <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Activate32BitServer">Activate32BitServer</a> and <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Activate64BitServer">Activate64BitServer</a>. On a 64-bit computer,
a 32-bit and 64-bit version of the same <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html">COM</a> server may coexist. When a client requests an activation of an out-of-process server,
these <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html">COM.CreateInstanceContext</a> flags allow the client to specify a 32-bit or a 64-bit version of the server.</p>
<p>Usually, a client will not care whether it uses a 32-bit or a 64-bit version of the server. However, if the server itself loads an additional
in-process server, then it and the in-process server must both be either 32-bit or 64-bit. For example, suppose that the client wants to use a server "A",
which in turn loads an in-process server "B". If only a 32-bit version of server "B" is available, then the client must specify the 32-bit version of server "A".
If only a 64-bit version of server "B" is available, then the client must specify the 64-bit version of server "A".</p>
<p>A server can specify its own architecture preference via the
<a href="https://learn.microsoft.com/en-us/windows/win32/com/preferredserverbitness">PreferredServerBitness</a> registry key, but the client's preference,
specified via a <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Activate32BitServer">Activate32BitServer</a> or <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Activate64BitServer">Activate64BitServer</a> flag, will override the server's preference. If the client does not specify
a preference, then the server's preference will be used.</p>
<p>If neither the client nor the server specifies a preference, then:</p>
<ul><li>If the computer that hosts the server is running Windows Server 2003 with Service Pack 1 (SP1) or a later system, then <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html">COM</a>
will try to match the server architecture to the client architecture. In other words, for a 32-bit client, <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html">COM</a> will activate a 32-bit server
if available; otherwise it will activate a 64-bit version of the server. For a 64-bit client, <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html">COM</a> will activate a 64-bit server if available;
otherwise it will activate a 32-bit server.</li><li>If the computer that hosts the server is running Windows XP or Windows Server 2003 without SP1 or later installed,
then <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.html">COM</a> will prefer a 64-bit version of the server if available; otherwise it will activate a 32-bit version of the server.</li></ul>
<p>If a <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html">COM.CreateInstanceContext</a> enumeration has both the <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Activate32BitServer">Activate32BitServer</a> and <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Activate64BitServer">Activate64BitServer</a> flags set,
then it is invalid and the activation will return <a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html#FireBlade_WinInteropUtils_HRESULT_E_INVALIDARG">E_INVALIDARG</a>.</p>
<p>The flags <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Activate32BitServer">Activate32BitServer</a> and <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.COM.CreateInstanceContext.html#FireBlade_WinInteropUtils_ComponentObjectModel_COM_CreateInstanceContext_Activate64BitServer">Activate64BitServer</a> flow across computer boundaries. If the computer that hosts
the server is running the 64-bit Windows, then it will honor these flags; otherwise it will ignore them.</p>
</div>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/FireBlade211/WinInteropUtils/blob/main/WinInteropUtils/ComponentObjectModel/COM.cs/#L317" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
