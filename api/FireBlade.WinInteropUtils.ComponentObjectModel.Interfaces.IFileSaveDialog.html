<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Interface IFileSaveDialog | WinInteropUtils </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Interface IFileSaveDialog | WinInteropUtils ">
      
      <meta name="description" content="Extends the  interface by adding methods specific to the save dialog, which include those that provide support for the collection of metadata to be persisted with the file.">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/FireBlade211/WinInteropUtils/new/main/apiSpec/new?filename=FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog.md&amp;value=---%0Auid%3A%20FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="WinInteropUtils">
            WinInteropUtils
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog">



  <h1 id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog" data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog" class="text-break">
Interface IFileSaveDialog  <a class="header-action link-secondary" title="View source" href="https://github.com/FireBlade211/WinInteropUtils/blob/main/WinInteropUtils/ComponentObjectModel/Interfaces/CommonItemDialogInterfaces.cs/#L318"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="FireBlade.html">FireBlade</a>.<a class="xref" href="FireBlade.WinInteropUtils.html">WinInteropUtils</a>.<a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.html">ComponentObjectModel</a>.<a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.html">Interfaces</a></dd></dl>
  <dl><dt>Assembly</dt><dd>WinInteropUtils.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Extends the <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html">IFileDialog</a> interface by adding methods specific to the save dialog, which include those that provide support for the collection
of metadata to be persisted with the file.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
[Guid(&quot;84bccd23-5fde-4cdb-aea4-af64b83d78ab&quot;)]
public interface IFileSaveDialog : IFileDialog, IModalWindow, IUnknown</code></pre>
  </div>







  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_SetFileTypes_System_UInt32_System_IntPtr_">IFileDialog.SetFileTypes(uint, nint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_SetFileTypeIndex_System_UInt32_">IFileDialog.SetFileTypeIndex(uint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_GetFileTypeIndex_System_UInt32__">IFileDialog.GetFileTypeIndex(out uint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_Advise_System_IntPtr_System_UInt32__">IFileDialog.Advise(nint, out uint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_Unadvise_System_UInt32_">IFileDialog.Unadvise(uint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_SetOptions_System_UInt32_">IFileDialog.SetOptions(uint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_GetOptions_System_UInt32__">IFileDialog.GetOptions(out uint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_SetDefaultFolder_System_IntPtr_">IFileDialog.SetDefaultFolder(nint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_SetFolder_System_IntPtr_">IFileDialog.SetFolder(nint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_GetFolder_System_IntPtr__">IFileDialog.GetFolder(out nint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_GetCurrentSelection_System_IntPtr__">IFileDialog.GetCurrentSelection(out nint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_SetFileName_System_String_">IFileDialog.SetFileName(string)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_GetFileName_System_IntPtr__">IFileDialog.GetFileName(out nint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_SetTitle_System_String_">IFileDialog.SetTitle(string)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_Close_FireBlade_WinInteropUtils_HRESULT_">IFileDialog.Close(HRESULT)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_GetResult_System_IntPtr__">IFileDialog.GetResult(out nint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_SetFilter_System_IntPtr_">IFileDialog.SetFilter(nint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IModalWindow.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IModalWindow_Show_System_IntPtr_">IModalWindow.Show(nint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IUnknown.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IUnknown_QueryInterface_System_Guid__System_IntPtr__">IUnknown.QueryInterface(ref Guid, out nint)</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IUnknown.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IUnknown_AddRef">IUnknown.AddRef()</a>
    </div>
    <div>
      <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IUnknown.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IUnknown_Release">IUnknown.Release()</a>
    </div>
  </dd></dl>






  <h2 class="section" id="methods">Methods
</h2>


  <a id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_ApplyProperties_" data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.ApplyProperties*"></a>

  <h3 id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_ApplyProperties_System_IntPtr_System_IntPtr_System_IntPtr_System_IntPtr_" data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.ApplyProperties(System.IntPtr,System.IntPtr,System.IntPtr,System.IntPtr)">
  ApplyProperties(nint, nint, nint, nint)
  <a class="header-action link-secondary" title="View source" href="https://github.com/FireBlade211/WinInteropUtils/blob/main/WinInteropUtils/ComponentObjectModel/Interfaces/CommonItemDialogInterfaces.cs/#L407"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Applies a set of properties to an item using the Shell's copy engine.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">HRESULT ApplyProperties(nint psi, nint pStore, nint hwnd, nint pSink)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>psi</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.intptr">nint</a></dt>
    <dd><p>Pointer to the <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IShellItem.html">IShellItem</a> that represents the file being saved.
This is usually the item retrieved by <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileDialog_GetResult_System_IntPtr__">GetResult(out nint)</a>.</p>
</dd>
    <dt><code>pStore</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.intptr">nint</a></dt>
    <dd><p>Pointer to the IPropertyStore that represents the property values to be applied to the file.
This can be the property store returned by <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_GetProperties_System_IntPtr__">GetProperties(out nint)</a>.</p>
</dd>
    <dt><code>hwnd</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.intptr">nint</a></dt>
    <dd><p>The handle of the application window.</p>
</dd>
    <dt><code>pSink</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.intptr">nint</a></dt>
    <dd><p>Pointer to an optional IFileOperationProgressSink that the calling application can use if they want to be notified
of the progress of the property stamping. This value may be <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html">HRESULT</a></dt>
    <dd><p>If this method succeeds, it returns <a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html#FireBlade_WinInteropUtils_HRESULT_S_OK">S_OK</a>. Otherwise, it returns an <a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html">HRESULT</a> error code.</p>
</dd>
  </dl>







  <h4 class="section" id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_ApplyProperties_System_IntPtr_System_IntPtr_System_IntPtr_System_IntPtr__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>This method should be used when the application has turned on property collection (<a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetCollectedProperties_System_IntPtr_System_Boolean_">SetCollectedProperties(nint, bool)</a>),
    but does not persist the properties themselves into the saved file.</p>
<pre><code>&lt;i&gt;Note: The file represented by the item specified in &lt;code class=&quot;paramref&quot;&gt;psi&lt;/code&gt; must exist in physical storage before making the call
to &lt;xref href=&quot;FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.ApplyProperties(System.IntPtr%2cSystem.IntPtr%2cSystem.IntPtr%2cSystem.IntPtr)&quot; data-throw-if-not-resolved=&quot;false&quot;&gt;&lt;/xref&gt;, so it must have been previously saved at some point.&lt;/i&gt;
</code></pre>
</div>




  <a id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_GetProperties_" data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.GetProperties*"></a>

  <h3 id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_GetProperties_System_IntPtr__" data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.GetProperties(System.IntPtr@)">
  GetProperties(out nint)
  <a class="header-action link-secondary" title="View source" href="https://github.com/FireBlade211/WinInteropUtils/blob/main/WinInteropUtils/ComponentObjectModel/Interfaces/CommonItemDialogInterfaces.cs/#L388"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Retrieves the set of property values for a saved item or an item in the process of being saved.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">HRESULT GetProperties(out nint ppStore)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>ppStore</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.intptr">nint</a></dt>
    <dd><p>Address of a pointer to an IPropertyStore that receives the property values.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html">HRESULT</a></dt>
    <dd><p>If this method succeeds, it returns <a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html#FireBlade_WinInteropUtils_HRESULT_S_OK">S_OK</a>. Otherwise, it returns an <a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html">HRESULT</a> error code.</p>
</dd>
  </dl>







  <h4 class="section" id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_GetProperties_System_IntPtr___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>This method can be called while the dialog is showing to retrieve the current set of values in the metadata collection pane.
It can also be called after the dialog has closed, to retrieve the final set of values.</p>
<p>The call to this method will fail unless property collection has been turned on with a call to <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetCollectedProperties_System_IntPtr_System_Boolean_">SetCollectedProperties(nint, bool)</a>.</p>
</div>




  <a id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetCollectedProperties_" data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.SetCollectedProperties*"></a>

  <h3 id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetCollectedProperties_System_IntPtr_System_Boolean_" data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.SetCollectedProperties(System.IntPtr,System.Boolean)">
  SetCollectedProperties(nint, bool)
  <a class="header-action link-secondary" title="View source" href="https://github.com/FireBlade211/WinInteropUtils/blob/main/WinInteropUtils/ComponentObjectModel/Interfaces/CommonItemDialogInterfaces.cs/#L375"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Specifies which properties will be collected in the save dialog.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">HRESULT SetCollectedProperties(nint pStore, bool fAppendDefault)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>pStore</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.intptr">nint</a></dt>
    <dd><p>Pointer to the interface that represents the list of properties to collect. This parameter can be <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/keywords/null">null</a>.</p>
</dd>
    <dt><code>fAppendDefault</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p><a href="https://learn.microsoft.com/dotnet/csharp/language-reference/builtin-types/bool">true</a> to show default properties for the currently selected filetype in addition to the properties
specified by <code class="paramref">pStore</code>. <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/builtin-types/bool">false</a> to show only properties specified by <code class="paramref">pStore</code>.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html">HRESULT</a></dt>
    <dd><p>If this method succeeds, it returns <a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html#FireBlade_WinInteropUtils_HRESULT_S_OK">S_OK</a>. Otherwise, it returns an <a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html">HRESULT</a> error code.</p>
</dd>
  </dl>







  <h4 class="section" id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetCollectedProperties_System_IntPtr_System_Boolean__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>The calling application can use the PSGetPropertyDescriptionListFromString function to construct an IPropertyDescriptionList
from a string such as "prop:Comments;Subject;".</p>
<p>For more information about property schemas,
see <a href="https://learn.microsoft.com/en-us/windows/desktop/properties/building-property-handlers-property-schemas">Property Schemas</a>.</p>
<p><a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetCollectedProperties_System_IntPtr_System_Boolean_">SetCollectedProperties(nint, bool)</a> can be called at any time before the dialog is displayed or while it is visible.
If different properties are to be collected depending on the chosen filetype, then <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetCollectedProperties_System_IntPtr_System_Boolean_">SetCollectedProperties(nint, bool)</a>
can be called in response to OnTypeChange.</p>
<p><i>Note: By default, no properties are collected in the save dialog.</i></p>
</div>




  <a id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetProperties_" data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.SetProperties*"></a>

  <h3 id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetProperties_System_IntPtr_" data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.SetProperties(System.IntPtr)">
  SetProperties(nint)
  <a class="header-action link-secondary" title="View source" href="https://github.com/FireBlade211/WinInteropUtils/blob/main/WinInteropUtils/ComponentObjectModel/Interfaces/CommonItemDialogInterfaces.cs/#L353"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Provides a property store that defines the default values to be used for the item being saved.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">HRESULT SetProperties(nint pStore)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>pStore</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.intptr">nint</a></dt>
    <dd><p>Pointer to the IPropertyStore interface that represents the property store that contains the associated metadata.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html">HRESULT</a></dt>
    <dd><p>If this method succeeds, it returns <a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html#FireBlade_WinInteropUtils_HRESULT_S_OK">S_OK</a>. Otherwise, it returns an <a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html">HRESULT</a> error code.</p>
</dd>
  </dl>







  <h4 class="section" id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetProperties_System_IntPtr__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>This method can be called at any time before the dialog is opened or while the dialog is showing. If an item has inherent properties,
this method should be called with those properties before showing the dialog.</p>
<p>When using Save As, the application should provide the properties of the item being saved to the Save dialog. Those properties should be retreived
from the original item by calling <code>GetPropertyStore</code> with the <code>GPS_HANDLERPROPERTIESONLY</code> flag.</p>
<p>To retrieve the properties of the saved item (which may have been modified by the user) after the dialog
closes, call <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_GetProperties_System_IntPtr__">GetProperties(out nint)</a>.</p>
<p>To turn on property collection and indicate which properties should be displayed in the Save dialog, use <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.html#FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetCollectedProperties_System_IntPtr_System_Boolean_">SetCollectedProperties(nint, bool)</a>.</p>
</div>




  <a id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetSaveAsItem_" data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.SetSaveAsItem*"></a>

  <h3 id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetSaveAsItem_System_IntPtr_" data-uid="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IFileSaveDialog.SetSaveAsItem(System.IntPtr)">
  SetSaveAsItem(nint)
  <a class="header-action link-secondary" title="View source" href="https://github.com/FireBlade211/WinInteropUtils/blob/main/WinInteropUtils/ComponentObjectModel/Interfaces/CommonItemDialogInterfaces.cs/#L334"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Sets an item to be used as the initial entry in a Save As dialog.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">HRESULT SetSaveAsItem(nint psi)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>psi</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.intptr">nint</a></dt>
    <dd><p>Pointer to an <a class="xref" href="FireBlade.WinInteropUtils.ComponentObjectModel.Interfaces.IShellItem.html">IShellItem</a> that represents the item.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html">HRESULT</a></dt>
    <dd><p>If this method succeeds, it returns <a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html#FireBlade_WinInteropUtils_HRESULT_S_OK">S_OK</a>. Otherwise, it returns an <a class="xref" href="FireBlade.WinInteropUtils.HRESULT.html">HRESULT</a> error code.</p>
</dd>
  </dl>







  <h4 class="section" id="FireBlade_WinInteropUtils_ComponentObjectModel_Interfaces_IFileSaveDialog_SetSaveAsItem_System_IntPtr__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>The name of the item is displayed in the file name edit box, and the containing folder is opened in the view.
This would generally be used when the application is saving an item that already exists. For new items, use SetFileName(string).</p>
</div>





</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/FireBlade211/WinInteropUtils/blob/main/WinInteropUtils/ComponentObjectModel/Interfaces/CommonItemDialogInterfaces.cs/#L318" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
